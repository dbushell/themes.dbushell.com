/*!
 *
 *  Copyright (c) David Bushell | @dbushell | http://dbushell.com/
 *
 */
!function(a,b,c){"use strict";a.Tales=function(){var d=0,e={},f=c(b.documentElement),g=c(a);return e.init=function(){if(!d++){var b=[0,0],h=0,i=0,j=c("#header"),k=j.outerHeight(),l=c(".wrapper"),m=c(".main"),n=c(".banner--half, .banner--cover").first(),o=c(".search-modal"),p=c(".search-modal__criteria");c(".prose > table").wrap('<div class="table-container"/>');var q=a.location.hash||"";q.length>1&&c.each(q.substring(1).split(","),function(a,b){f.addClass("js--"+b),"nav"===b&&(e.isNav=!0),"search"===b&&(e.isSearch=!0,setTimeout(function(){p.focus()},1))});var r=c(".menu--collapsed");if(r.on("click",".menu__toggle",function(a){return a.preventDefault(),c(a.delegateTarget).toggleClass("menu--collapsed"),!1}),e.navOpen=function(a){return a&&a.preventDefault(),f.addClass("js--nav"),e.isNav=!0,!1},e.navClose=function(a){return a&&a.preventDefault(),f.removeClass("js--nav"),e.isNav=!1,!1},e.searchOpen=function(a){return a&&a.preventDefault(),e.isSearch?(f.removeClass("js--search"),e.isSearch=!1):(f.addClass("js--search"),setTimeout(function(){p.focus()},1),e.isSearch=!0),!1},e.searchClose=function(a){return a&&a.preventDefault(),f.removeClass("js--search"),e.isSearch=!1,!1},c(".header__nav").on("click",e.navOpen),c(".nav__return").on("click",e.navClose),l.on("click",function(){e.isNav&&e.navClose()}),a.Modernizr.csstransforms3d&&(c(".header__search").on("click",e.searchOpen),o.on("click",function(a){c(a.target).hasClass("field")||e.searchClose()})),g.on("keydown",function(a){var b=a.keyCode||a.which;27===b&&(e.isSearch&&e.searchClose(),e.isNav&&e.navClose())}),n.filter(".banner--half").length)var s=n.outerHeight();c('a[href][data-scroll="true"]').on("click",function(a){var b=c(this).attr("href");if(b&&0===b.indexOf("#")){var d=c(b);d.length&&(a.preventDefault(),c("html,body").animate({scrollTop:d.offset().top}))}}),e.onResize=function(){var a=g.width(),b=g.height();return a===h&&Math.abs(i-b)<100?!1:(h=a,i=b,l.css({"min-height":i}),s&&(s=n.outerHeight()),n.filter(".banner--cover").css({"min-height":i}),void e.onScroll())},e.isHeaderFixed=j.hasClass("header--fixed"),e.isBanner=n.length;var t;e.onScroll=function(a){b[0]=b[1],b[1]=g.scrollTop(),e.isHeaderFixed||(b[1]=0),e.isBanner&&(b[1]<(s||i)-k?j.addClass("js--cover"):j.removeClass("js--cover")),b[1]>k?b[1]>b[0]?j.addClass("js--fixed js--inactive"):j.removeClass("js--inactive"):j.removeClass("js--fixed"),clearTimeout(t),a&&(t=setTimeout(function(){g.scrollTop()<=0&&j.removeClass("js--fixed js--inactive")},300))},e.isHeaderFixed&&c(a).on("resize scroll orientationchange",c.throttle(50,e.onScroll)),c(a).on("resize orientationchange",c.throttle(10,e.onResize)),e.onResize(),e.onScroll(),f.addClass("js--ready"),m.fitVids()}},e}(),c(b).ready(function(){a.Tales.init()})}(window,window.document,window.jQuery),function(a,b){var c,d=a.jQuery||a.Cowboy||(a.Cowboy={});d.throttle=c=function(a,c,e,f){function g(){function d(){i=+new Date,e.apply(j,l)}function g(){h=b}var j=this,k=+new Date-i,l=arguments;f&&!h&&d(),h&&clearTimeout(h),f===b&&k>a?d():c!==!0&&(h=setTimeout(f?g:d,f===b?a-k:a))}var h,i=0;return"boolean"!=typeof c&&(f=e,e=c,c=b),d.guid&&(g.guid=e.guid=e.guid||d.guid++),g},d.debounce=function(a,d,e){return e===b?c(a,d,!1):c(a,e,d!==!1)}}(this),/*!
* FitVids 1.0.3
*
* Copyright 2013, Chris Coyier - http://css-tricks.com + Dave Rupert - http://daverupert.com
* Credit to Thierry Koblentz - http://www.alistapart.com/articles/creating-intrinsic-ratios-for-video/
* Released under the WTFPL license - http://sam.zoy.org/wtfpl/
*
* Date: Thu Sept 01 18:00:00 2011 -0500
*/
function(a){"use strict";a.fn.fitVids=function(b){var c={customSelector:null};if(!document.getElementById("fit-vids-style")){var d=document.createElement("div"),e=document.getElementsByTagName("base")[0]||document.getElementsByTagName("script")[0],f="&shy;<style>.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style>";d.className="fit-vids-style",d.id="fit-vids-style",d.style.display="none",d.innerHTML=f,e.parentNode.insertBefore(d,e)}return b&&a.extend(c,b),this.each(function(){var b=["iframe[src*='player.vimeo.com']","iframe[src*='youtube.com']","iframe[src*='youtube-nocookie.com']","iframe[src*='kickstarter.com'][src*='video.html']","object","embed"];c.customSelector&&b.push(c.customSelector);var d=a(this).find(b.join(","));d=d.not("object object"),d.each(function(){var b=a(this);if(!("embed"===this.tagName.toLowerCase()&&b.parent("object").length||b.parent(".fluid-width-video-wrapper").length)){var c="object"===this.tagName.toLowerCase()||b.attr("height")&&!isNaN(parseInt(b.attr("height"),10))?parseInt(b.attr("height"),10):b.height(),d=isNaN(parseInt(b.attr("width"),10))?b.width():parseInt(b.attr("width"),10),e=c/d;if(!b.attr("id")){var f="fitvid"+Math.floor(999999*Math.random());b.attr("id",f)}b.wrap('<div class="fluid-width-video-wrapper"></div>').parent(".fluid-width-video-wrapper").css("padding-top",100*e+"%"),b.removeAttr("height").removeAttr("width")}})})}}(window.jQuery||window.Zepto);